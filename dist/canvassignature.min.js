!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define("cavnassignature",e):(t="undefined"!=typeof globalThis?globalThis:t||self).cavnassignature=e()}(this,function(){"use strict";function e(t,e,n){var l=t.length,o=[];for(e=r(l,e),n=r(l,n,l);e<n;)o.push(t[e++]);return o}function r(t,e,n){return e=null==e?n||0:e<0?Math.max(t+e,0):Math.min(e,t)}function l(n,l,o){!function(t,e,n){for(var l in t)if(!1===e.call(n,t[l],l,t))break}(n,function(t,e){if(a.call(n,e))return l.call(o,n[e],e,n)})}function n(n,t){return null==n?{}:(function(t,e,n){if(null!=t)for(var l=t.length,o=-1;++o<l;){var r=t[o];if(!1===e.call(n,r,o,t))break}}(e(arguments,1),function(t){var e;null!=(e=t)&&"object"==typeof e&&!1===Array.isArray(e)&&l(t,function(t,e){null==n[e]&&(n[e]=t)})}),n)}var a=Object.prototype.hasOwnProperty,t=n;t.immutable=function(){var t=e(arguments);return n.apply(null,[{}].concat(t))};const o=(t,e)=>{let n=t.querySelector("canvas");return null!==n?(e.trim?(t=>{for(var e,n,l=t.getContext("2d"),o=document.createElement("canvas").getContext("2d"),r=l.getImageData(0,0,t.width,t.height),a=r.data.length,i={top:null,left:null,right:null,bottom:null},u=0;u<a;u+=4)0!==r.data[u+3]&&(e=u/4%t.width,n=~~(u/4/t.width),null===i.top&&(i.top=n),(null===i.left||e<i.left)&&(i.left=e),(null===i.right||i.right<e)&&(i.right=e),(null===i.bottom||i.bottom<n)&&(i.bottom=n));if(null===i.left||null===i.right||null===i.top||null===i.bottom)return t;var c=i.bottom-i.top,s=i.right-i.left,l=l.getImageData(i.left,i.top,s,c);return o.canvas.width=s,o.canvas.height=c,o.putImageData(l,0,0),o.canvas})(n):n).toDataURL():null};var i=(n,l)=>(l=t(l,{width:200,height:120,trim:!0,strokeWidth:2,strokeColor:"black"}),n&&Array.prototype.forEach.call(n.length?n:[n],t=>{((t,r)=>{if(null!==t&&"div"===t.nodeName.toLowerCase()){let n=document.createElement("canvas"),e=n.getContext("2d"),l=!1,o={};const a=t=>{t.preventDefault(),l=!0,o=c(t)},i=t=>{t.preventDefault(),l=!1},u=t=>{l&&(t=c(t),e.lineWidth=r.strokeWidth,e.strokeStyle=r.strokeColor,e.moveTo(o.x,o.y),e.lineTo(t.x,t.y),e.stroke(),o=t)},c=t=>{let e={};return t.targetTouches&&t.targetTouches.length&&(e.x=t.targetTouches[0].clientX-n.offsetLeft,e.y=t.targetTouches[0].clientY-n.offsetTop),t.clientX&&t.clientY&&(e.x=t.clientX-n.offsetLeft,e.y=t.clientY-n.offsetTop),e};t.appendChild(n),n.className="canvasSignature",n.width=r.width,n.height=r.height,n.style="overscroll-behavior-y: contain;",n.addEventListener("touchstart",a,{passive:!1}),n.addEventListener("touchmove",u,{passive:!1}),n.addEventListener("touchend",i),n.addEventListener("mousedown",a),n.addEventListener("mousemove",u),n.addEventListener("mouseup",i)}})(t,l)}),{clear:()=>{Array.prototype.forEach.call(n.length?n:[n],t=>{(t=>{let e=t.querySelector("canvas");null!==e&&(e.width=e.width)})(t)})},getSignatures:()=>{let e=[];return Array.prototype.forEach.call(n.length?n:[n],t=>{e.push(o(t,l))}),e},getSignature:()=>{var t=n.length?n:[elemen];return o(t[0],l)},destroy:()=>{Array.prototype.forEach.call(n.length?n:[n],t=>{(t=>{let e=t.querySelector("canvas");null!==e&&e.remove()})(t)})}});return window.CanvasSignature=i});